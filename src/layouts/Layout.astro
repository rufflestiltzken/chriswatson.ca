---
const { title = "Chris Watson" } = Astro.props;
const rawPath = Astro.url.pathname;

// Normalize: remove trailing slash except for root "/"
const pathname =
  rawPath.endsWith("/") && rawPath !== "/" ? rawPath.slice(0, -1) : rawPath;
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Chris Watson – economic development, technology, and public-sector innovation."
    />
    <link rel="icon" href="/favicon.svg" />
    <title>{title}</title>
    <style>
      :root {
        /* Light mode */
        --bg: #ffffff;
        --text: #111111;
        --muted: #6b7280;
        --border: #e5e7eb;
        --accent: #007aff; /* Apple-ish blue */

        /* Helps form controls match theme */
        color-scheme: light dark;
      }

      @media (prefers-color-scheme: dark) {
        :root {
          /* Dark mode */
          --bg: #0b0b0f;
          --text: #f5f5f7;
          --muted: #a1a1aa;
          --border: rgba(255, 255, 255, 0.12);
          --accent: #0a84ff; /* iOS dark-mode blue */
        }
      }

      body {
        margin: 0;
        font-family:
          system-ui,
          -apple-system,
          BlinkMacSystemFont,
          "Segoe UI",
          Roboto,
          Helvetica,
          Arial,
          sans-serif;
        font-size: 18px;
        line-height: 1.7;
        color: var(--text);
        background: var(--bg);
        -webkit-font-smoothing: antialiased;
        text-rendering: optimizeLegibility;
      }

      header {
        padding: 2.25rem 0;
      }

      nav {
        max-width: 720px;
        margin: 0 auto;
        padding: 0 2rem;
        display: flex;
        gap: 2rem;
        flex-wrap: wrap; /* key for mobile */
        align-items: center;
      }

      nav a {
        text-decoration: none;
        color: var(--muted);
        font-weight: 500;
        padding: 0.25rem 0; /* improves tap target a bit */
      }

      nav a:hover {
        color: var(--text);
      }

      nav a[aria-current="page"] {
        color: var(--accent);
      }

      main {
        max-width: 720px;
        margin: 4rem auto;
        padding: 0 2rem;
      }

      h1 {
        font-size: 2.25rem;
        font-weight: 600;
        margin: 0 0 1.5rem;
        letter-spacing: -0.01em;
      }

      p {
        margin: 0 0 1.5rem;
      }

      footer {
        margin-top: 4rem;
        text-align: center;
      }

      footer hr {
        opacity: 0.15;
        margin-bottom: 2.5rem;
      }

      .contact {
        margin-bottom: 2rem;
      }

      .contact h2 {
        font-size: 0.9rem;
        font-weight: 500;
        letter-spacing: 0.08em;
        text-transform: uppercase;
        color: var(--text-muted);
        margin-bottom: 0.75rem;
      }

      .contact p {
        font-size: 0.95rem;
      }

      .contact a {
        color: inherit;
        text-decoration: none;
      }

      .contact a:hover {
        text-decoration: underline;
      }

      .copyright {
        font-size: 0.8rem;
        color: var(--text-muted);
      }

      /* Mobile refinement */
      @media (max-width: 640px) {
        body {
          font-size: 17px;
        }

        header {
          padding: 1.75rem 0;
        }

        nav {
          gap: 1.25rem;
          padding: 0 1.25rem;
        }

        main {
          margin: 3rem auto;
          padding: 0 1.25rem;
        }

        footer {
          padding: 1.25rem 1.25rem 0;
        }
      }
    </style>
  </head>
  <body>
    <header>
      <nav>
        <a href="/" aria-current={pathname === "/" ? "page" : undefined}>
          Home
        </a>
        <a
          href="/about"
          aria-current={pathname === "/about" ? "page" : undefined}
        >
          About
        </a>
        <a
          href="/projects"
          aria-current={pathname === "/projects" ? "page" : undefined}
        >
          Projects
        </a>
        <a
          href="/writing"
          aria-current={pathname === "/writing" ? "page" : undefined}
        >
          Writing
        </a>
      </nav>
    </header>

    <main>
      <slot />
    </main>

    <footer>
      <hr />

      <div class="contact">
        <h2>Contact</h2>
        <p>
          <a href="mailto:chris@chriswatson.ca">chris@chriswatson.ca</a><br />
          <a href="https://www.linkedin.com/in/yourprofile">LinkedIn</a> ·
          <a href="https://github.com/yourprofile">GitHub</a>
        </p>
      </div>

      <p class="copyright">© 2026 Chris Watson</p>
    </footer>
  </body>
</html>

<style>
  html,
  body {
    margin: 0;
    width: 100%;
    height: 100%;
  }
</style>
